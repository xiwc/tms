define("app",["exports","toastr","wurl","common/common-utils","tms-semantic-ui","lodash"],function(n,e,t,o){"use strict";function r(n){return n&&n.__esModule?n:{default:n}}function i(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.App=void 0;var a=r(e),d=r(t),s=r(o);n.App=function(){function n(){i(this,n),window.toastr=a.default,window.wurl=d.default,window.utils=s.default,this.init()}return n.prototype.init=function(){_.extend($.fn.form.settings.prompt,{empty:"{name}不能为空",checked:"{name}必须被勾选",email:"{name}必须是正确的邮件格式",url:"{name}必须是正确的URL格式",regExp:"{name}验证格式不正确",integer:"{name}必须为一个整数",decimal:"{name}必须为一个小数",number:"{name}必须设置为一个数字",is:'{name}必须符合规则"{ruleValue}"',isExactly:'{name}必须精确匹配"{ruleValue}"',not:'{name}不能设置为"{ruleValue}"',notExactly:'{name}不能准确设置为"{ruleValue}"',contain:'{name}需要包含"{ruleValue}"',containExactly:'{name}需要精确包含"{ruleValue}"',doesntContain:'{name}不能包含"{ruleValue}"',doesntContainExactly:'{name}不能精确包含"{ruleValue}"',minLength:"{name}必须至少包含{ruleValue}个字符",length:"{name}必须为{ruleValue}个字符",exactLength:"{name}必须为{ruleValue}个字符",maxLength:"{name}必须不能超过{ruleValue}个字符",match:"{name}必须匹配{ruleValue}字段",different:"{name}必须不同于{ruleValue}字段",creditCard:"{name}必须是一个正确的信用卡数字格式",minCount:"{name}必须至少包含{ruleValue}个选择项",exactCount:"{name}必须准确包含{ruleValue}个选择项",maxCount:"{name} 必须有{ruleValue}或者更少个选择项"})},n.prototype.configureRouter=function(n,e){n.map([{route:["pwd-reset"],name:"reset",moduleId:"user/user-pwd-reset",nav:!1,title:"密码重置"},{route:["register"],name:"register",moduleId:"user/user-register",nav:!1,title:"用户注册"},{route:["chat-direct/:username"],name:"chat-direct",moduleId:"chat/chat-direct",nav:!1,title:"私聊"},{route:["login"],name:"login",moduleId:"user/user-login",nav:!1,title:"登录"},{route:["test"],name:"test",moduleId:"test/test-lifecycle",nav:!1,title:"测试"},{route:"",redirect:"chat-direct/admin"}]),this.router=e},n}()}),define("environment",["exports"],function(n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={debug:!1,testing:!1}}),define("main",["exports","./environment"],function(n,e){"use strict";function t(n){return n&&n.__esModule?n:{default:n}}function o(n){n.use.standardConfiguration().feature("resources"),r.default.debug&&n.use.developmentLogging(),r.default.testing&&n.use.plugin("aurelia-testing"),n.start().then(function(){return n.setRoot()})}Object.defineProperty(n,"__esModule",{value:!0}),n.configure=o;var r=t(e);Promise.config({warnings:{wForgottenReturn:!1}})}),define("chat/chat-direct",["exports","aurelia-framework","common/common-poll","marked","clipboard","dropzone","autosize","jquery.scrollto","common/common-plugin","timeago","hotkeys"],function(n,e,t,o,r,i,a){"use strict";function d(n){return n&&n.__esModule?n:{default:n}}function s(n,e,t,o){t&&Object.defineProperty(n,e,{enumerable:t.enumerable,configurable:t.configurable,writable:t.writable,value:t.initializer?t.initializer.call(o):void 0})}function l(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function c(n,e,t,o,r){var i={};return Object.keys(o).forEach(function(n){i[n]=o[n]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=t.slice().reverse().reduce(function(t,o){return o(n,e,t)||t},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,e,i),i=null),i}Object.defineProperty(n,"__esModule",{value:!0}),n.ChatDirect=void 0;var m,u,p=d(t),h=d(o),f=d(r),b=d(i),y=d(a);n.ChatDirect=(m=function(){function n(){l(this,n),s(this,"content",u,this),this.offset=0,this.selfLink=utils.getBaseUrl()+wurl("path")+"#"+utils.getHash(),this.first=!0,this.last=!0,this.lastSearch=!0,this.originalHref=wurl(),this.chatTo=null,h.default.setOptions({breaks:!0}),b.default.autoDiscover=!1,this.poll=p.default,new f.default(".tms-chat-direct .tms-clipboard").on("success",function(n){toastr.success("复制到剪贴板成功!")}).on("error",function(n){toastr.error("复制到剪贴板成功!")})}return n.prototype.convertMd=function(n){return _.each(n,function(n){n.contentMd=(0,h.default)(n.content)}),n},n.prototype.activate=function(n,e,t){this.markId=n.id,this.routeConfig=e,this.user=_.find(this.users,{username:n.username});var o=this.user?this.user.name:n.username;e.navModel.setTitle(o+" | 私聊 | TMS"),this.init(n.username),$(this.chatToDropdownRef).dropdown("set selected",this.chatTo),this.markId&&("pushState"in history?history.replaceState(null,"",utils.removeUrlQuery("id")):window.location.href=utils.removeUrlQuery("id"))},n.prototype.lastMoreHandler=function(){var n=this,e=_.first(this.chats).id;$.get("/admin/chat/direct/more",{last:!0,start:e,size:20,chatTo:this.chatTo},function(t){t.success?(n.chats=_.unionBy(_.reverse(n.convertMd(t.data)),n.chats),n.last=t.msgs[0]-t.data.length<=0,!n.last&&(n.lastCnt=t.msgs[0]-t.data.length),_.defer(function(){$(n.commentsRef).scrollTo(".comment[data-id="+e+"]",{offset:n.offset})})):toastr.error(t.data,"获取更多消息失败!")})},n.prototype.firstMoreHandler=function(){var n=this,e=_.last(this.chats).id;$.get("/admin/chat/direct/more",{last:!1,start:e,size:20,chatTo:this.chatTo},function(t){t.success?(n.chats=_.unionBy(n.chats,n.convertMd(t.data)),n.first=t.msgs[0]-t.data.length<=0,!n.first&&(n.firstCnt=t.msgs[0]-t.data.length),_.defer(function(){$(n.commentsRef).scrollTo(".comment[data-id="+e+"]",{offset:n.offset})})):toastr.error(t.data,"获取更多消息失败!")})},n.prototype.init=function(n){var e=this;this.chatTo=n;var t={size:20,chatTo:n};this.markId&&(t.id=this.markId),$.get("/admin/chat/direct/list",t,function(n){n.success?(e.chats=_.reverse(e.convertMd(n.data.content)),e.last=n.data.last,e.first=n.data.first,!e.last&&(e.lastCnt=n.data.totalElements-n.data.numberOfElements),!e.first&&(e.firstCnt=n.data.size*n.data.number),_.defer(function(){e.markId?$(e.commentsRef).scrollTo(".comment[data-id="+e.markId+"]",{offset:e.offset}):$(e.commentsRef).scrollTo("max")})):(toastr.error(n.data,"获取消息失败!"),window.location=utils.getBaseUrl()+wurl("path")+("#/login?redirect="+encodeURIComponent(e.originalHref)))}).always(function(n,t,o){"error"==t&&(window.location=utils.getBaseUrl()+wurl("path")+("#/login?redirect="+encodeURIComponent(e.originalHref)))})},n.prototype.bind=function(n){var e=this;$.get("/admin/user/loginUser",function(n){n.success?e.loginUser=n.data:toastr.error(n.data,"获取当前登录用户失败!")}),$.get("/admin/user/all",{enabled:!0},function(n){n.success?(e.users=n.data,e.user=_.find(e.users,{username:e.chatTo}),e.user&&e.routeConfig.navModel.setTitle(e.user.name+" | 私聊 | TMS")):toastr.error(n.data,"获取全部用户失败!")}),p.default.start(function(n,t){if(e.chats){var o=_.last(e.chats);$.get("/admin/chat/direct/latest",{id:o?o.id:0,chatTo:e.chatTo},function(n){if(n.success){if(0==n.data.length)return;e.chats=_.unionBy(e.chats,e.convertMd(n.data),"id"),_.defer(function(){$(e.commentsRef).scrollTo("max")})}else toastr.error(n.data,"轮询获取消息失败!")}).fail(function(){t(),utils.errorAutoTry(function(){n()})})}})},n.prototype.unbind=function(){p.default.stop()},n.prototype.chatToUserFilerKeyupHanlder=function(n){var e=this;if(_.each(this.users,function(n){n.hidden=n.username.indexOf(e.filter)==-1}),13===n.keyCode){var t=_.find(this.users,{hidden:!1});t&&(window.location=wurl("path")+("#/chat-direct/"+t.username))}},n.prototype.clearFilterHandler=function(){var n=this;this.filter="",_.each(this.users,function(e){e.hidden=e.username.indexOf(n.filter)==-1})},n.prototype.deleteHandler=function(n){var e=this;this.emConfirmModal.show({onapprove:function(){$.post("/admin/chat/direct/delete",{id:n.id},function(t,o,r){t.success?(e.chats=_.reject(e.chats,{id:n.id}),toastr.success("删除消息成功!")):toastr.error(t.data,"删除消息失败!")})}})},n.prototype.editHandler=function(n,e){n.isEditing=!0,_.defer(function(){$(e).focus().select(),y.default.update(e)})},n.prototype.eidtKeydownHandler=function(n,e,t){var o=this;if(this.sending)return!1;if(!n.ctrlKey&&13===n.keyCode){this.sending=!0,e.content=$(t).val();var r=$('<div class="markdown-body"/>').html('<style>.markdown-body{font-size:14px;line-height:1.6}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a.absent{color:#C00}.markdown-body a.anchor{bottom:0;cursor:pointer;display:block;left:0;margin-left:-30px;padding-left:30px;position:absolute;top:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{cursor:text;font-weight:700;margin:20px 0 10px;padding:0;position:relative}.markdown-body h1 .mini-icon-link,.markdown-body h2 .mini-icon-link,.markdown-body h3 .mini-icon-link,.markdown-body h4 .mini-icon-link,.markdown-body h5 .mini-icon-link,.markdown-body h6 .mini-icon-link{color:#000;display:none}.markdown-body h1:hover a.anchor,.markdown-body h2:hover a.anchor,.markdown-body h3:hover a.anchor,.markdown-body h4:hover a.anchor,.markdown-body h5:hover a.anchor,.markdown-body h6:hover a.anchor{line-height:1;margin-left:-22px;padding-left:0;text-decoration:none;top:15%}.markdown-body h1:hover a.anchor .mini-icon-link,.markdown-body h2:hover a.anchor .mini-icon-link,.markdown-body h3:hover a.anchor .mini-icon-link,.markdown-body h4:hover a.anchor .mini-icon-link,.markdown-body h5:hover a.anchor .mini-icon-link,.markdown-body h6:hover a.anchor .mini-icon-link{display:inline-block}.markdown-body hr:after,.markdown-body hr:before{display:table;content:""}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{color:#000;font-size:28px}.markdown-body h2{border-bottom:1px solid #CCC;color:#000;font-size:24px}.markdown-body h3{font-size:18px}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:14px}.markdown-body h6{color:#777;font-size:14px}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin:15px 0}.markdown-body hr{overflow:hidden;background:#e7e7e7;height:4px;padding:0;margin:16px 0;border:0;-moz-box-sizing:content-box;box-sizing:content-box}.markdown-body h1+p,.markdown-body h2+p,.markdown-body h3+p,.markdown-body h4+p,.markdown-body h5+p,.markdown-body h6+p,.markdown-body ol li>:first-child,.markdown-body ul li>:first-child{margin-top:0}.markdown-body hr:after{clear:both}.markdown-body a:first-child h1,.markdown-body a:first-child h2,.markdown-body a:first-child h3,.markdown-body a:first-child h4,.markdown-body a:first-child h5,.markdown-body a:first-child h6,.markdown-body>h1:first-child,.markdown-body>h1:first-child+h2,.markdown-body>h2:first-child,.markdown-body>h3:first-child,.markdown-body>h4:first-child,.markdown-body>h5:first-child,.markdown-body>h6:first-child{margin-top:0;padding-top:0}.markdown-body li p.first{display:inline-block}.markdown-body ol,.markdown-body ul{padding-left:30px}.markdown-body ol.no-list,.markdown-body ul.no-list{list-style-type:none;padding:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-bottom:0}.markdown-body dl{padding:0}.markdown-body dl dt{font-size:14px;font-style:italic;font-weight:700;margin:15px 0 5px;padding:0}.markdown-body dl dt:first-child{padding:0}.markdown-body dl dt>:first-child{margin-top:0}.markdown-body dl dt>:last-child{margin-bottom:0}.markdown-body dl dd{margin:0 0 15px;padding:0 15px}.markdown-body blockquote>:first-child,.markdown-body dl dd>:first-child{margin-top:0}.markdown-body blockquote>:last-child,.markdown-body dl dd>:last-child{margin-bottom:0}.markdown-body blockquote{border-left:4px solid #DDD;color:#777;padding:0 15px}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{border:1px solid #CCC;padding:6px 13px}.markdown-body table tr{background-color:#FFF;border-top:1px solid #CCC}.markdown-body table tr:nth-child(2n){background-color:#F8F8F8}.markdown-body img{max-width:100%}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{border:1px solid #DDD;display:block;float:left;margin:13px 0 0;overflow:hidden;padding:7px;width:auto}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{clear:both;color:#333;display:block;padding:5px 0 0}.markdown-body span.align-center{clear:both;display:block;overflow:hidden}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{clear:both;display:block;overflow:hidden}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{background-color:#F8F8F8;border:1px solid #EAEAEA;border-radius:3px;margin:0 2px;padding:0 5px;white-space:nowrap}.markdown-body pre>code{background:none;border:none;margin:0;padding:0;white-space:pre}.markdown-body .highlight pre,.markdown-body pre{background-color:#F8F8F8;border:1px solid #CCC;border-radius:3px;font-size:13px;line-height:19px;overflow:auto;padding:6px 10px}.markdown-body pre code,.markdown-body pre tt{background-color:transparent;border:none}</style>'+(0,h.default)(e.content)).wrap("<div/>").parent().html();return $.post("/admin/chat/direct/update",{baseUrl:utils.getBaseUrl(),path:wurl("path"),id:e.id,content:e.content,contentHtml:r},function(n,t,o){n.success?(toastr.success("更新消息成功!"),e.contentMd=(0,h.default)(e.content),e.isEditing=!1):toastr.error(n.data,"更新消息失败!")}).always(function(){o.sending=!1}),!1}if(n.ctrlKey&&13===n.keyCode){var i=$(n.target);i.insertAtCaret("\n"),y.default.update(t),e.content=i.val()}return!0},n.prototype.focusoutHandler=function(n){n.isEditing=!1},n.prototype.chatToUserFilerFocusinHanlder=function(){$(this.userListRef).scrollTo('a.item[data-id="'+this.chatTo+'"]')},n.prototype.attached=function(){var n=this;_.delay(function(){$(n.userListRef).scrollTo('a.item[data-id="'+n.chatTo+'"]')},1e3);var e=timeago();this.timeagoTimer=setInterval(function(){$(n.chatContainerRef).find("[data-timeago]").each(function(n,t){$(t).text(e.format($(t).attr("data-timeago"),"zh_CN"))})},5e3),this.initSearch(),this.initHotkeys()},n.prototype.initSearch=function(){var n=this,e=[];if(localStorage){var t=localStorage.getItem("tms/chat-direct:search");e=t?$.parseJSON(t):[]}this.searchSource=e,$(this.searchRef).search({source:e,onSelect:function(e,t){n.searchHandler()},onResults:function(){$(n.searchRef).search("hide results")}})},n.prototype.searchKeyupHandler=function(n){return 13===n.keyCode&&this.searchHandler(),!0},n.prototype.searchHandler=function(){var n=this;$(this.searchRef).search("hide results");var e=$(this.searchInputRef).val();if(!e||e.length<2)return void toastr.error("检索条件至少需要两个字符!");this.search=e;var t=!1;$.each(this.searchSource,function(n,o){if(o.title==e)return t=!0,!1}),t||(this.searchSource.splice(0,0,{title:e}),$(this.searchRef).search({source:_.clone(this.searchSource)})),localStorage&&localStorage.setItem("tms/chat-direct:search",JSON.stringify(this.searchSource)),$.get("/admin/chat/direct/search",{search:this.search,size:20,page:0},function(e){e.success&&(n.toggleRightSidebar(!0),n.searchChats=e.data.content,_.each(n.searchChats,function(n){n.contentMd=(0,h.default)(n.content)}),n.searchPage=e.data,n.lastSearch=e.data.last,n.moreSearchCnt=e.data.totalElements-(e.data.number+1)*e.data.size)})},n.prototype.searchMoreHandler=function(){var n=this;$.get("/admin/chat/direct/search",{search:this.search,size:this.searchPage.size,page:this.searchPage.number+1},function(e){e.success&&(_.each(e.data.content,function(n){n.contentMd=(0,h.default)(n.content)}),n.searchChats=_.concat(n.searchChats,e.data.content),n.searchPage=e.data,n.lastSearch=e.data.last,n.moreSearchCnt=e.data.totalElements-(e.data.number+1)*e.data.size)})},n.prototype.clearSearchHandler=function(){$(this.searchInputRef).val("").focus()},n.prototype.initHotkeys=function(){var n=this;$(document).bind("keydown","ctrl+u",function(e){e.preventDefault(),$(n.emChatInputRef.btnItemUploadRef).find(".content").click()}).bind("keydown","ctrl+/",function(e){e.preventDefault(),n.emChatInputRef.emHotkeysModal.show()})},n.prototype.unbind=function(){clearInterval(this.timeagoTimer)},n.prototype.initChatToDropdownHandler=function(n){var e=this;n&&_.defer(function(){$(e.chatToDropdownRef).dropdown().dropdown("set selected",e.chatTo).dropdown({onChange:function(n,e,t){window.location=wurl("path")+("#/chat-direct/"+n)}})})},n.prototype.sibebarRightHandler=function(){this.toggleRightSidebar()},n.prototype.toggleRightSidebar=function(n){_.isUndefined(n)?this.isRightSidebarShow=!this.isRightSidebarShow:this.isRightSidebarShow=n,this.isRightSidebarShow&&$(this.contentBodyRef).width($(this.contentRef).width()-392)},n.prototype.starHandler=function(){this.isStarShow=!this.isStarShow,this.toggleRightSidebar(this.isStarShow)},n.prototype.searchFocusinHandler=function(){$(this.searchInputRef).css("width","auto"),$(this.searchRemoveRef).show()},n.prototype.searchFocusoutHandler=function(){$(this.searchInputRef).val()||($(this.searchInputRef).css("width","100px"),$(this.searchRemoveRef).hide())},n.prototype.gotoChatHandler=function(n){var e=_.find(this.chats,{id:n.id});e?($(this.commentsRef).find(".comment[data-id]").removeClass("active"),$(this.commentsRef).find(".comment[data-id="+n.id+"]").addClass("active"),$(this.commentsRef).scrollTo(".comment[data-id="+n.id+"]",{offset:this.offset})):this.chatTo==n.chatTo.username?this.activate({id:n.id,username:n.chatTo.username},this.routeConfig):window.location=wurl("path")+("#/chat-direct/"+n.chatTo.username+"?id="+n.id)},n}(),u=c(m.prototype,"content",[e.bindable],{enumerable:!0,initializer:function(){return""}}),m)}),define("common/common-plugin",[],function(){"use strict";!function(n){n.fn.extend({insertAtCaret:function(e){var t=n(this)[0];if(document.selection)this.focus(),sel=document.selection.createRange(),sel.text=e,this.focus();else if(t.selectionStart||"0"==t.selectionStart){var o=t.selectionStart,r=t.selectionEnd,i=t.scrollTop;t.value=t.value.substring(0,o)+e+t.value.substring(r,t.value.length),this.focus(),t.selectionStart=o+e.length,t.selectionEnd=o+e.length,t.scrollTop=i}else this.value+=e,this.focus()}})}(jQuery)}),define("common/common-poll",["exports"],function(n){"use strict";function e(){if(!f)try{p&&p(r,o)}catch(n){h&&h(r,o,n),console.log("轮询异常: "+n)}}function t(){console.log("poll start..."),f=!1,e(),c=setInterval(function(){m++,e(),m>l&&(u=a+s*(m-l),u<=d&&(clearInterval(c),t()))},u)}function o(){console.log("poll stop..."),m=0,u=a,f=!1,clearInterval(c),c=null}function r(){console.log("poll reset..."),o(),t()}function i(){console.log("pause reset..."),f=!0}Object.defineProperty(n,"__esModule",{value:!0});var a=6e3,d=3e5,s=6e3,l=10,c=null,m=0,u=a,p=null,h=null,f=!1;n.default={start:function(n,e){c&&o(),p=n,h=e,t()},reset:function(){r()},stop:function(){o()},pause:function(){i()}}}),define("common/common-tips",["exports"],function(n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={"/h1":{label:"/h1 [标题1]",value:"# "},"/h2":{label:"/h2 [标题2]",value:"## "},"/h3":{label:"/h3 [标题3]",value:"### "},"/h4":{label:"/h4 [标题4]",value:"#### "},"/h5":{label:"/h5 [标题5]",value:"##### "},"/h6":{label:"/h6 [标题6]",value:"###### "},"/b":{label:"/b [粗体]",value:"****"},"/i":{label:"/i [斜体]",value:"**"},"/s":{label:"/s [删除线]",value:"~~~~"},"/code":{label:"/code [代码]",value:"```\n\n```\n"},"/quote":{label:"/quote [引用]",value:"> "},"/list":{label:"/list [列表]",value:"* "},"/href":{label:"/href [链接]",value:"[](http://)"},"/img":{label:"/img [图片]",value:"![](http://)"},"/table":{label:"/table [表格]",value:"| 列1 | 列2 | 列3 |\n| ------ | ------ | ------ |\n| 文本 | 文本 | 文本 |\n"},"/hr":{label:"/hr [分隔线]",value:"\n-----\n"},"/upload":{label:"/upload [上传文件]",value:""},"/shortcuts":{label:"/shortcuts [热键]",value:""}}}),define("common/common-utils",["exports"],function(n){"use strict";function e(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var t=n.CommonUtils=function(){function n(){e(this,n)}return n.prototype.getBaseUrl=function(){return"function"==typeof wurl?80==wurl("port")||443==wurl("port")?wurl("protocol")+"://"+wurl("hostname"):wurl("protocol")+"://"+wurl("hostname")+":"+wurl("port"):""},n.prototype.getHash=function(){var n=wurl("hash"),e=n.indexOf("?");return e!=-1?n.substring(0,e):n},n.prototype.urlQuery=function(n){return wurl("?"+n)||wurl("?"+n,wurl("hash"))},n.prototype.removeUrlQuery=function(n,e){var t=e?e:window.location.href,o=new RegExp("(&|\\?)?"+n+"=?[^&#]*(.)?","g").exec(t);if(o){if("&"==o[1])return t.replace(new RegExp("&"+n+"=?[^&#]+","g"),"");if("?"==o[1])return"&"!=o[2]?t.replace(new RegExp("\\?"+n+"=?[^&#]*","g"),""):t.replace(new RegExp(""+n+"=?[^&#]*&","g"),"")}return t},n.prototype.errorAutoTry=function(n,e){var t=this;if(!this.isRunning){var o=e?e:10,r=null,i=toastr.error("网络连接错误,"+o+"秒后自动重试!",null,{closeButton:!1,timeOut:"0",preventDuplicates:!1,onclick:function(){clearInterval(t.timer),n&&n()}});this.isRunning=!0,r=setInterval(function(){return 0===o?(clearInterval(r),t.isRunning=!1,toastr.remove(),void(n&&n())):(i&&i.find(".toast-message").text("网络连接错误,"+o+"秒后自动重试!"),void o--)},1e3)}},n}();n.default=new t}),define("resources/config",["exports","aurelia-fetch-client","aurelia-framework","toastr","nprogress","isomorphic-fetch"],function(n,e,t,o,r){"use strict";function i(n){return n&&n.__esModule?n:{default:n}}function a(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.Config=void 0;var d=i(o),s=i(r),l=n.Config=function(){function n(){a(this,n)}return n.prototype.initHttp=function(){return window.json=function(n){return console.log(JSON.stringify(n)),(0,e.json)(n)},window.http=this.aurelia.container.root.get(e.HttpClient),http.configure(function(n){n.withDefaults({credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"fetch"}}).withInterceptor({request:function(n){return s.default&&s.default.start(),n},requestError:function(n){console.log(n)},response:function(n){return s.default&&s.default.done(),n.ok||(n.json().then(function(n){d.default.error(n.message)}),401!=n.status)?n:void d.default.error("用户未登录!")},responseError:function(n){d.default.error(n.message,"网络请求错误!"),console.log(n)}})}),this},n.prototype.initToastr=function(){return d.default.options.positionClass="toast-bottom-center",d.default.options.preventDuplicates=!0,this},n.prototype.initAjax=function(){return $(document).on("ajaxStart",function(){s.default&&s.default.start()}),$(document).on("ajaxStop",function(){s.default&&s.default.done()}),this},n.prototype.context=function(n){return this.aurelia=n,this},n}();n.default=new l}),define("resources/index",["exports","./config"],function(n,e){"use strict";function t(n){return n&&n.__esModule?n:{default:n}}function o(n){r.default.context(n).initHttp().initToastr().initAjax(),n.globalResources(["resources/value-converters/vc-common","resources/attributes/attr-task","resources/attributes/attr-swipebox","resources/attributes/attr-pastable","resources/attributes/attr-autosize"])}Object.defineProperty(n,"__esModule",{value:!0}),n.configure=o;var r=t(e)}),define("test/test-lifecycle",["exports","aurelia-framework","aurelia-event-aggregator"],function(n,e,t){"use strict";function o(n,e,t,o){t&&Object.defineProperty(n,e,{enumerable:t.enumerable,configurable:t.configurable,writable:t.writable,value:t.initializer?t.initializer.call(o):void 0})}function r(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function i(n,e,t,o,r){var i={};return Object.keys(o).forEach(function(n){i[n]=o[n]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=t.slice().reverse().reduce(function(t,o){return o(n,e,t)||t},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,e,i),i=null),i}Object.defineProperty(n,"__esModule",{value:!0}),n.TestLifeCycle=void 0;var a,d,s,l;n.TestLifeCycle=(l=s=function(){function n(e){r(this,n),o(this,"prop",d,this),this.eventAggregator=e,console.log("constructor")}return n.prototype.created=function(n){console.log("created")},n.prototype.bind=function(n){console.log("bind")},n.prototype.unbind=function(){console.log("unbind")},n.prototype.attached=function(){console.log("attached")},n.prototype.detached=function(){console.log("detached")},n.prototype.canActivate=function(n,e,t){console.log("canActivate")},n.prototype.activate=function(n,e,t){console.log("activate")},n.prototype.canDeactivate=function(){console.log("canDeactivate")},n.prototype.deactivate=function(){console.log("deactivate")},n}(),s.inject=[t.EventAggregator],a=l,d=i(a.prototype,"prop",[e.bindable],{enumerable:!0,initializer:function(){return null}}),a)}),define("user/user-login",["exports"],function(n){"use strict";function e(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});n.UserLogin=function(){function n(){e(this,n),this.username="",this.password=""}return n.prototype.attached=function(){$(this.rememberMeRef).checkbox()},n.prototype.kdHandler=function(n){return 13===n.keyCode&&this.loginHandler(),!0},n.prototype.loginHandler=function(){var n=this;$.get("/admin/login",function(e){var t=$(n.rememberMeRef).checkbox("is checked")?"on":"";$.post("/admin/signin",{username:n.username,password:n.password,"remember-me":t}).always(function(){var n=utils.urlQuery("redirect");n?window.location=decodeURIComponent(n):window.location=wurl("path")})})},n}()}),define("user/user-pwd-reset",["exports"],function(n){"use strict";function e(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});n.UserPwdReset=function(){function n(){e(this,n),this.mail="",this.pwd="",this.isReq=!1,this.token=utils.urlQuery("id")}return n.prototype.resetPwdHandler=function(){var n=this;return $(this.fm).form("is valid")?(this.isReq=!0,void http.fetch("/free/user/pwd/reset",{method:"post",body:json({mail:this.mail,baseUrl:utils.getBaseUrl(),path:wurl("path")})}).then(function(e){e.ok&&e.json().then(function(e){e.success?(toastr.success("重置密码邮件链接发送成功!"),_.delay(function(){window.location="/admin/login"},2e3)):(toastr.error(e.data,"重置密码邮件链接发送失败!"),n.isReq=!1)})})):void toastr.error("邮件地址输入不合法!")},n.prototype.newPwdHandler=function(){var n=this;return $(this.fm2).form("is valid")?(this.isReq=!0,void http.fetch("/free/user/pwd/new",{method:"post",body:json({token:this.token,pwd:this.pwd})}).then(function(e){e.ok&&e.json().then(function(e){e.success?(toastr.success("重置密码成功!"),_.delay(function(){window.location="/admin/login"},2e3)):(toastr.error(e.data,"重置密码失败!"),n.isReq=!1)})})):void toastr.error("新密码输入不合法!")},n.prototype.attached=function(){$(this.fm).form({on:"blur",inline:!0,fields:{mail:["empty","email"]}}),$(this.fm2).form({on:"blur",inline:!0,fields:{mail:["empty","minLength[8]"]}})},n}()}),define("user/user-register",["exports"],function(n){"use strict";function e(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});n.ViewModel=function(){function n(){e(this,n),this.header="账户激活页面"}return n.prototype.activate=function(n,e,t){var o=this;n.id&&(this.token=n.id,this.isReq=!0,this.header="账户激活中,请稍后...!",http.fetch("/free/user/register/activate",{method:"post",body:json({token:this.token})}).then(function(n){n.ok&&(n.json().then(function(n){n.success?o.header="账户激活成功,请返回登录页面登录!":(o.header="账户激活失败!",toastr.error(n.data,"账户激活失败!"))}),o.isReq=!1)}))},n.prototype.attached=function(){$(this.fm).form({on:"blur",inline:!0,fields:{username:{identifier:"username",rules:[{type:"empty"},{type:"minLength[3]"},{type:"regExp",value:/^[a-z]+[a-z0-9\.\-_]*[a-z0-9]+$/,prompt:"小写字母数字.-_组合,字母开头,字母数字结尾"}]},pwd:{identifier:"pwd",rules:[{type:"empty"},{type:"minLength[8]"}]},name:{identifier:"name",rules:[{type:"empty"},{type:"maxLength[20]"}]},mail:{identifier:"mail",rules:[{type:"empty"},{type:"email"}]}}})},n.prototype.okHandler=function(){var n=this;return $(this.fm).form("is valid")?(this.isReq=!0,void http.fetch("/free/user/register",{method:"post",body:json({username:this.username,pwd:this.pwd,name:this.name,mail:this.mail,baseUrl:utils.getBaseUrl(),path:wurl("path")})}).then(function(e){e.ok&&e.json().then(function(e){e.success?(toastr.success("注册成功,请通过接收到的激活邮件激活账户!"),_.delay(function(){window.location="/admin/login"},2e3)):(toastr.error(e.data,"注册失败!"),n.isReq=!1)})})):void toastr.error("账户注册信息输入不合法!")},n}()}),define("resources/attributes/attr-autosize",["exports","aurelia-framework","aurelia-templating","autosize"],function(n,e,t,o){"use strict";function r(n){return n&&n.__esModule?n:{default:n}}function i(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.AttrAutosize=void 0;var a,d,s,l=r(o);n.AttrAutosize=(a=(0,t.customAttribute)("autosize"),d=(0,e.inject)(Element),a(s=d(s=function(){function n(e){i(this,n),this.element=e}return n.prototype.valueChanged=function(n,e){(0,l.default)(this.element)},n.prototype.bind=function(n){this.valueChanged(this.value)},n.prototype.unbind=function(){l.default.destroy(this.elements)},n}())||s)||s)}),define("resources/attributes/attr-pastable",["exports","aurelia-framework","aurelia-templating","common/common-plugin","paste"],function(n,e,t){"use strict";function o(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.AttrPastable=void 0;var r,i,a;n.AttrPastable=(r=(0,t.customAttribute)("pastable"),i=(0,e.inject)(Element),r(a=i(a=function(){function n(e){o(this,n),this.element=e}return n.prototype.valueChanged=function(n,e){var t=this;$(this.element).pastableTextarea().on("pasteImage",function(n,e){$.post("/admin/file/base64",{dataURL:e.dataURL,type:e.blob.type},function(n,e,o){n.success&&$(t.element).insertAtCaret("![{name}]({baseURL}{path}{uuidName})".replace(/\{name\}/g,n.data.name).replace(/\{baseURL\}/g,utils.getBaseUrl()+"/").replace(/\{path\}/g,n.data.path).replace(/\{uuidName\}/g,n.data.uuidName))})}).on("pasteImageError",function(n,e){toastr.error(e.message,"剪贴板粘贴图片错误!")})},n.prototype.bind=function(n){this.valueChanged(this.value)},n}())||a)||a)}),define("resources/attributes/attr-swipebox",["exports","aurelia-framework","aurelia-templating","swipebox"],function(n,e,t){"use strict";function o(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.AttrSwipebox=void 0;var r,i,a;n.AttrSwipebox=(r=(0,t.customAttribute)("swipebox"),i=(0,e.inject)(Element),r(a=i(a=function(){function n(e){o(this,n),this.element=e}return n.prototype.valueChanged=function(n,e){var t=this;$(this.element).on("click","img",function(e){e.preventDefault();var o=($(e.target),[]),r=0;$(t.element).find("img").each(function(n,t){o.push({href:$(t).attr("src"),title:$(t).attr("alt")}),e.target==t&&(r=n)}),$.swipebox(o,{
useCSS:!0,useSVG:!0,initialIndexOnArray:r,hideCloseButtonOnMobile:!1,removeBarsOnMobile:!0,hideBarsDelay:3e3,videoMaxWidth:1140,beforeOpen:function(){},afterOpen:null,afterClose:function(){},loopAtEnd:!!n})})},n.prototype.bind=function(n){this.valueChanged(this.value)},n}())||a)||a)}),define("resources/attributes/attr-task",["exports","aurelia-dependency-injection","aurelia-templating"],function(n,e,t){"use strict";function o(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.AttrTask=void 0;var r,i,a;n.AttrTask=(r=(0,t.customAttribute)("task"),i=(0,e.inject)(Element),r(a=i(a=function(){function n(e){o(this,n),this.task=null,this.bindingCtx=null,this.element=e}return n.prototype.valueChanged=function(n){this.task=n,_.isFunction(this.task)&&_.bind(this.task,this.bindingCtx,this.element)()},n.prototype.bind=function(n){this.bindingCtx=n,this.valueChanged(this.value)},n.prototype.unbind=function(){this.element=null,this.task=null,this.bindingCtx=null},n}())||a)||a)}),define("resources/elements/em-chat-input",["exports","aurelia-framework","common/common-tips","simplemde","marked","textcomplete"],function(n,e,t,o,r){"use strict";function i(n){return n&&n.__esModule?n:{default:n}}function a(n,e,t,o){t&&Object.defineProperty(n,e,{enumerable:t.enumerable,configurable:t.configurable,writable:t.writable,value:t.initializer?t.initializer.call(o):void 0})}function d(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function s(n,e,t,o,r){var i={};return Object.keys(o).forEach(function(n){i[n]=o[n]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=t.slice().reverse().reduce(function(t,o){return o(n,e,t)||t},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,e,i),i=null),i}Object.defineProperty(n,"__esModule",{value:!0}),n.EmChatInput=void 0;var l,c,m,u,p=i(t),h=i(o),f=i(r);n.EmChatInput=(0,e.containerless)((c=function(){function n(){d(this,n),a(this,"chatTo",m,this),a(this,"poll",u,this)}return n.prototype.attached=function(){this.initSimpleMDE(this.chatInputRef),this.initDropzone(),this.initPaste()},n.prototype.initPaste=function(){var n=this;$(this.$chatMsgInputRef).pastableTextarea().on("pasteImage",function(e,t){$.post("/admin/file/base64",{dataURL:t.dataURL,type:t.blob.type},function(e,t,o){e.success&&n.insertContent("![{name}]({baseURL}{path}{uuidName})".replace(/\{name\}/g,e.data.name).replace(/\{baseURL\}/g,utils.getBaseUrl()+"/").replace(/\{path\}/g,e.data.path).replace(/\{uuidName\}/g,e.data.uuidName))})}).on("pasteImageError",function(n,e){toastr.error(e.message,"剪贴板粘贴图片错误!")})},n.prototype.initDropzone=function(){var n=this;this.initUploadDropzone($(".CodeMirror-wrap",this.inputRef),function(){return n.$chatMsgInputRef},!1),this.initUploadDropzone($(this.btnItemUploadRef).children().andSelf(),function(){return n.$chatMsgInputRef},!0),$(this.chatBtnRef).popup({inline:!0,hoverable:!0,position:"bottom left",delay:{show:300,hide:300}})},n.prototype.initUploadDropzone=function(n,e,t){var o=this;$(n).dropzone({url:"/admin/file/upload",paramName:"file",clickable:!!t,dictDefaultMessage:"",maxFilesize:10,addRemoveLinks:!0,previewsContainer:this.uploadProgressRef,previewTemplate:this.previewTemplateRef.innerHTML,dictCancelUpload:"取消上传",dictCancelUploadConfirmation:"确定要取消上传吗?",dictFileTooBig:"文件过大({{filesize}}M),最大限制:{{maxFilesize}}M",init:function(){this.on("sending",function(n,t,o){e()||this.removeAllFiles(!0)}),this.on("success",function(n,e){e.success?($.each(e.data,function(n,e){"Image"==e.type?o.insertContent("![{name}]({baseURL}{path}{uuidName}) ".replace(/\{name\}/g,e.name).replace(/\{baseURL\}/g,utils.getBaseUrl()+"/").replace(/\{path\}/g,e.path).replace(/\{uuidName\}/g,e.uuidName)):o.insertContent("[{name}]({baseURL}{path}{uuidName}) ".replace(/\{name\}/g,e.name).replace(/\{baseURL\}/g,utils.getBaseUrl()+"/").replace(/\{path\}/g,"admin/file/download/").replace(/\{uuidName\}/g,e.id))}),toastr.success("上传成功!")):toastr.error(e.data,"上传失败!")}),this.on("error",function(n,e,t){toastr.error(e,"上传失败!")}),this.on("complete",function(n){this.removeFile(n)})}})},n.prototype.initSimpleMDE=function(n){this.simplemde=new h.default({element:n,spellChecker:!1,status:!1,autofocus:!0,toolbar:!1,forceSync:!0,autoDownloadFontAwesome:!1,insertTexts:{table:["","\n\n| 列1 | 列2 | 列3 |\n| ------ | ------ | ------ |\n| 文本 | 文本 | 文本 |\n\n"]}}),this.$chatMsgInputRef=$(this.inputRef).find(".textareaWrapper .CodeMirror textarea"),this.initTextcomplete()},n.prototype.initTextcomplete=function(){var n=this;$(this.$chatMsgInputRef).textcomplete([{match:/(|\b)(\/.*)$/,search:function(n,e){var t=_.keys(p.default);e($.map(t,function(e){return 0===e.indexOf(n)?e:null}))},template:function(n,e){return p.default[n].label},replace:function(e){return n.tipsActionHandler(e),""}}],{appendTo:".tms-upload-progress",maxCount:20}),this.simplemde.codemirror.on("keydown",function(e,t){13===t.keyCode&&n.isTipsShow()?t.preventDefault():t.ctrlKey&&13===t.keyCode?n.sendChatMsg():27===t.keyCode?n.simplemde.value(""):t.ctrlKey&&85==t.keyCode?$(n.btnItemUploadRef).find(".content").click():t.ctrlKey&&191==t.keyCode&&n.emHotkeysModal.show()})},n.prototype.sendChatMsg=function(){var n=this,e=this.simplemde.value();if(!$.trim(e))return void this.simplemde.value("");if(!this.sending){this.sending=!0;var t=$('<div class="markdown-body"/>').html('<style>.markdown-body{font-size:14px;line-height:1.6}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a.absent{color:#C00}.markdown-body a.anchor{bottom:0;cursor:pointer;display:block;left:0;margin-left:-30px;padding-left:30px;position:absolute;top:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{cursor:text;font-weight:700;margin:20px 0 10px;padding:0;position:relative}.markdown-body h1 .mini-icon-link,.markdown-body h2 .mini-icon-link,.markdown-body h3 .mini-icon-link,.markdown-body h4 .mini-icon-link,.markdown-body h5 .mini-icon-link,.markdown-body h6 .mini-icon-link{color:#000;display:none}.markdown-body h1:hover a.anchor,.markdown-body h2:hover a.anchor,.markdown-body h3:hover a.anchor,.markdown-body h4:hover a.anchor,.markdown-body h5:hover a.anchor,.markdown-body h6:hover a.anchor{line-height:1;margin-left:-22px;padding-left:0;text-decoration:none;top:15%}.markdown-body h1:hover a.anchor .mini-icon-link,.markdown-body h2:hover a.anchor .mini-icon-link,.markdown-body h3:hover a.anchor .mini-icon-link,.markdown-body h4:hover a.anchor .mini-icon-link,.markdown-body h5:hover a.anchor .mini-icon-link,.markdown-body h6:hover a.anchor .mini-icon-link{display:inline-block}.markdown-body hr:after,.markdown-body hr:before{display:table;content:""}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{color:#000;font-size:28px}.markdown-body h2{border-bottom:1px solid #CCC;color:#000;font-size:24px}.markdown-body h3{font-size:18px}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:14px}.markdown-body h6{color:#777;font-size:14px}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin:15px 0}.markdown-body hr{overflow:hidden;background:#e7e7e7;height:4px;padding:0;margin:16px 0;border:0;-moz-box-sizing:content-box;box-sizing:content-box}.markdown-body h1+p,.markdown-body h2+p,.markdown-body h3+p,.markdown-body h4+p,.markdown-body h5+p,.markdown-body h6+p,.markdown-body ol li>:first-child,.markdown-body ul li>:first-child{margin-top:0}.markdown-body hr:after{clear:both}.markdown-body a:first-child h1,.markdown-body a:first-child h2,.markdown-body a:first-child h3,.markdown-body a:first-child h4,.markdown-body a:first-child h5,.markdown-body a:first-child h6,.markdown-body>h1:first-child,.markdown-body>h1:first-child+h2,.markdown-body>h2:first-child,.markdown-body>h3:first-child,.markdown-body>h4:first-child,.markdown-body>h5:first-child,.markdown-body>h6:first-child{margin-top:0;padding-top:0}.markdown-body li p.first{display:inline-block}.markdown-body ol,.markdown-body ul{padding-left:30px}.markdown-body ol.no-list,.markdown-body ul.no-list{list-style-type:none;padding:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-bottom:0}.markdown-body dl{padding:0}.markdown-body dl dt{font-size:14px;font-style:italic;font-weight:700;margin:15px 0 5px;padding:0}.markdown-body dl dt:first-child{padding:0}.markdown-body dl dt>:first-child{margin-top:0}.markdown-body dl dt>:last-child{margin-bottom:0}.markdown-body dl dd{margin:0 0 15px;padding:0 15px}.markdown-body blockquote>:first-child,.markdown-body dl dd>:first-child{margin-top:0}.markdown-body blockquote>:last-child,.markdown-body dl dd>:last-child{margin-bottom:0}.markdown-body blockquote{border-left:4px solid #DDD;color:#777;padding:0 15px}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{border:1px solid #CCC;padding:6px 13px}.markdown-body table tr{background-color:#FFF;border-top:1px solid #CCC}.markdown-body table tr:nth-child(2n){background-color:#F8F8F8}.markdown-body img{max-width:100%}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{border:1px solid #DDD;display:block;float:left;margin:13px 0 0;overflow:hidden;padding:7px;width:auto}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{clear:both;color:#333;display:block;padding:5px 0 0}.markdown-body span.align-center{clear:both;display:block;overflow:hidden}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{clear:both;display:block;overflow:hidden}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{background-color:#F8F8F8;border:1px solid #EAEAEA;border-radius:3px;margin:0 2px;padding:0 5px;white-space:nowrap}.markdown-body pre>code{background:none;border:none;margin:0;padding:0;white-space:pre}.markdown-body .highlight pre,.markdown-body pre{background-color:#F8F8F8;border:1px solid #CCC;border-radius:3px;font-size:13px;line-height:19px;overflow:auto;padding:6px 10px}.markdown-body pre code,.markdown-body pre tt{background-color:transparent;border:none}</style>'+(0,f.default)(e)).wrap("<div/>").parent().html();$.post("/admin/chat/direct/create",{baseUrl:utils.getBaseUrl(),path:wurl("path"),chatTo:this.chatTo,content:e,contentHtml:t},function(e,t,o){e.success?(n.poll.reset(),n.simplemde.value("")):toastr.error(e.data,"发送消息失败!")}).always(function(){n.sending=!1})}},n.prototype.sendChatMsgHandler=function(){this.sendChatMsg()},n.prototype.isTipsShow=function(){return 1===$(this.uploadProgressRef).find(".textcomplete-dropdown:visible").size()},n.prototype.insertTipContent=function(n,e){var t=e?e.codemirror:this.simplemde.codemirror,o=t.getCursor(),r=t.getLine(o.line),i=_.lastIndexOf(r,"/",o.ch);o&&(t.replaceRange(n,{ch:i,line:o.line},o),t.focus())},n.prototype.insertContent=function(n,e){var t=e?e.codemirror:this.simplemde.codemirror,o=t.getCursor();o&&(t.replaceRange(n,o,o),t.focus())},n.prototype.tipsActionHandler=function(n){"/upload"==n?$(this.btnItemUploadRef).find(".content").click():"/shortcuts"==n?this.emHotkeysModal.show():this.insertTipContent(p.default[n].value)},n}(),m=s(c.prototype,"chatTo",[e.bindable],{enumerable:!0,initializer:null}),u=s(c.prototype,"poll",[e.bindable],{enumerable:!0,initializer:null}),l=c))||l}),define("resources/elements/em-confirm-modal",["exports","aurelia-framework"],function(n,e){"use strict";function t(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.EmConfirmModal=void 0;n.EmConfirmModal=function(){function n(){t(this,n),this.config={}}return n.prototype.detached=function(){$(this.md).remove()},n.prototype.attached=function(){var n=this;$(this.md).modal({closable:!1,onApprove:function(){n.onapprove&&n.onapprove()},onDeny:function(){n.ondeny&&n.ondeny()}})},n.prototype.reset=function(){this.config={title:"操作确认",content:"确定要执行该操作吗?",warning:!1}},n.prototype.show=function(n){this.reset(),n&&(this.config=_.extend(this.config,n)),n&&n.onapprove&&(this.onapprove=n.onapprove),n&&n.ondeny&&(this.ondeny=n.ondeny),$(this.md).modal("show")},n.prototype.hide=function(){$(this.md).modal("hide")},n}()}),define("resources/elements/em-hotkeys-modal",["exports","aurelia-framework"],function(n,e){"use strict";function t(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.EmHotkeysModal=void 0;n.EmHotkeysModal=function(){function n(){t(this,n)}return n.prototype.attached=function(){$(this.md).modal()},n.prototype.show=function(){$(this.md).modal("show")},n}()}),define("resources/value-converters/vc-common",["exports","jquery-format","timeago"],function(n){"use strict";function e(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.TimeagoValueConverter=n.NumberValueConverter=n.DateValueConverter=n.LowerValueConverter=n.UpperValueConverter=void 0;var t=timeago();n.UpperValueConverter=function(){function n(){e(this,n)}return n.prototype.toView=function(n){return n&&n.toUpperCase()},n}(),n.LowerValueConverter=function(){function n(){e(this,n)}return n.prototype.toView=function(n){return n&&n.toLowerCase()},n}(),n.DateValueConverter=function(){function n(){e(this,n)}return n.prototype.toView=function(n){var e=arguments.length<=1||void 0===arguments[1]?"yyyy-MM-dd hh:mm:ss":arguments[1];return _.isInteger(_.toNumber(n))?$.format.date(new Date(n),e):n?n:""},n}(),n.NumberValueConverter=function(){function n(){e(this,n)}return n.prototype.toView=function(n){var e=arguments.length<=1||void 0===arguments[1]?"#,##0.00":arguments[1];return _.isNumber(_.toNumber(n))?$.format.number(n,e):n?n:""},n}(),n.TimeagoValueConverter=function(){function n(){e(this,n)}return n.prototype.toView=function(n){return n?t.format(n,"zh_CN"):""},n}()}),define("text!app.html",["module"],function(n){n.exports='<template>\r\n\t<require from="./app.css"></require>\r\n\t<require from="nprogress/nprogress.css"></require>\r\n\t<require from="toastr/build/toastr.css"></require>\r\n    <require from="tms-semantic-ui/semantic.min.css"></require>\r\n    <router-view></router-view>\r\n</template>\r\n'}),define("text!chat/chat-direct.html",["module"],function(n){n.exports='<template>\r\n    <require from="./chat-direct.css"></require>\r\n    <require from="./md-github.css"></require>\r\n    <require from="dropzone/dist/basic.css"></require>\r\n    <require from="swipebox/src/css/swipebox.min.css"></require>\r\n    <require from="simplemde/dist/simplemde.min.css"></require>\r\n    <require from="resources/elements/em-confirm-modal"></require>\r\n    <require from="resources/elements/em-chat-input"></require>\r\n    <div ref="chatContainerRef" class="tms-chat-direct">\r\n        <div class="ui top fixed menu">\r\n            <!-- <div class="item">\r\n                <i class="icon link sidebar"></i>\r\n            </div> -->\r\n            <div ref="chatToDropdownRef" class="ui dropdown link item">\r\n                <i class="big loading at icon"></i>\r\n                <span class="text"></span>\r\n                <i class="dropdown icon"></i>\r\n                <div class="menu">\r\n                    <div class="ui icon search input">\r\n                        <i class="search icon"></i>\r\n                        <input type="text" placeholder="过滤私聊对象">\r\n                    </div>\r\n                    <div class="divider"></div>\r\n                    <div class="header">\r\n                        <i class="user icon"></i> 切换私聊对象\r\n                    </div>\r\n                    <div class="scrolling menu">\r\n                        <a repeat.for="item of users" task.bind="initChatToDropdownHandler($last)" href="#/chat-direct/${item.username}" class="item" title="${item.username}" data-value="${item.username}">\r\n                            <i class="circular icon user"></i> ${item.name}\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class="right menu">\r\n                <div class="item tms-item">\r\n                    <button click.delegate="sibebarRightHandler()" title="右侧边栏" class="basic ${isRightSidebarShow ? \'active\' : \'\'} ui icon button">\r\n                        <i class="columns icon"></i>\r\n                    </button>\r\n                </div>\r\n                <!-- <div class="item tms-item">\r\n                    <button click.delegate="starHandler()" title="收藏消息" class="basic ${isStarShow ? \'active\' : \'\'} ui icon button">\r\n                        <i class="empty star icon"></i>\r\n                    </button>\r\n                </div> -->\r\n                <div class="item">\r\n                    <div ref="searchRef" class="ui search">\r\n                        <div class="ui left icon input">\r\n                            <input ref="searchInputRef" keyup.trigger="searchKeyupHandler($event)" focusout.trigger="searchFocusoutHandler()" focusin.trigger="searchFocusinHandler()" class="prompt" type="text" placeholder="搜索...">\r\n                            <i class="search icon"></i>\r\n                            <i ref="searchRemoveRef" click.delegate="clearSearchHandler()" class="remove link icon"></i>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <a class="item">\r\n                    <i class="circular user icon"></i> ${loginUser.name}\r\n                </a>\r\n            </div>\r\n        </div>\r\n        <div ref="sidebarRef" class="ui left visible segment sidebar tms-left-sidebar">\r\n            <div class="tms-header">\r\n                <h1 class="ui header"><a href="/admin/dynamic?scroll=1">私聊频道</a></h1>\r\n                <input value.bind="filter" focusin.trigger="chatToUserFilerFocusinHanlder()" keyup.trigger="chatToUserFilerKeyupHanlder($event)" type="text" placeholder="私聊对象查找">\r\n                <i title="清空过滤输入" click.delegate="clearFilterHandler()" class="bordered close icon link small"></i>\r\n            </div>\r\n            <div ref="userListRef" class="ui middle aligned selection list">\r\n                <a repeat.for="item of users" title="${item.username}" show.bind="!item.hidden" href="#/chat-direct/${item.username}" class="item ${item.username == chatTo ? \'active\' : \'\'}" data-id="${item.username}">\r\n                    <i class="circular icon user"></i>\r\n                    <div class="content">\r\n                        <div style="color: black;">${item.name ? item.name : item.username}</div>\r\n                    </div>\r\n                </a>\r\n            </div>\r\n        </div>\r\n        <div ref="contentRef" class="tms-content ${isRightSidebarShow ? \'tms-sidebar-show\' : \'\'}">\r\n            <div ref="contentBodyRef" class="tms-content-body">\r\n                <div ref="commentsRef" class="ui basic segment minimal selection list segment comments">\r\n                    <button if.bind="!last" click.delegate="lastMoreHandler()" class="fluid basic ui button tms-pre-more">加载更多(${lastCnt})</button>\r\n                    <div repeat.for="item of chats" swipebox class="comment item ${item.id == markId ? \'active\' : \'\'}" data-id="${item.id}">\r\n                        <a class="avatar">\r\n                            <i class="circular icon large user"></i>\r\n                        </a>\r\n                        <div class="content">\r\n                            <a class="author">${item.creator.name}</a>\r\n                            <div class="metadata">\r\n                                <div class="date" data-timeago="${item.createDate}" title="${item.createDate | date}">${item.createDate | timeago}</div>\r\n                            </div>\r\n                            <div show.bind="!item.isEditing" class="text markdown-body" innerhtml.bind="item.contentMd"></div>\r\n                            <textarea ref="editTxtRef" pastable autosize focusout.trigger="focusoutHandler(item)" keydown.trigger="eidtKeydownHandler($event, item, editTxtRef)" show.bind="item.isEditing" value.bind="item.content" class="tms-edit-textarea" rows="1"></textarea>\r\n                            <div class="actions">\r\n                                <a if.bind="item.creator.username == loginUser.username" click.delegate="editHandler(item, editTxtRef)" class="tms-edit">编辑</a>\r\n                                <a if.bind="item.creator.username == loginUser.username" click.delegate="deleteHandler(item)" class="tms-delete">删除</a>\r\n                                <a class="tms-copy tms-clipboard" data-clipboard-text="${item.content}">复制</a>\r\n                                <a class="tms-share tms-clipboard" data-clipboard-text="${selfLink + \'?id=\' + item.id}">分享</a>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <button if.bind="!first" click.delegate="firstMoreHandler()" class="fluid basic ui button tms-next-more">加载更多(${firstCnt})</button>\r\n                </div>\r\n                <em-chat-input chat-to.bind="chatTo" poll.bind="poll" em-chat-input.ref="emChatInputRef"></em-chat-input>\r\n            </div>\r\n            <div ref="rightSidebarRef" class="tms-right-sidebar">\r\n                <div class="panel-search">\r\n                    <div class="ui basic segment minimal selection list segment comments">\r\n                        <h1 show.bind="!searchChats.length" class="ui center aligned header">无符合检索结果</h1>\r\n                        <div repeat.for="item of searchChats" swipebox class="comment item ${item.id == markId ? \'active\' : \'\'}" data-id="${item.id}">\r\n                            <a class="avatar">\r\n                                <i class="circular icon large user"></i>\r\n                            </a>\r\n                            <div class="content">\r\n                                <a class="author">${item.creator.name}</a>\r\n                                <div class="metadata">\r\n                                    <div class="date" data-timeago="${item.createDate}" title="${item.createDate | date}">${item.createDate | timeago}</div>\r\n                                </div>\r\n                                <div class="text markdown-body" innerhtml.bind="item.contentMd"></div>\r\n                                <div class="actions">\r\n                                    <a click.delegate="gotoChatHandler(item)" class="tms-goto" href="">定位</a>\r\n                                    <a class="tms-copy tms-clipboard" data-clipboard-text="${item.content}">复制</a>\r\n                                    <a class="tms-share tms-clipboard" data-clipboard-text="${selfLink + \'?id=\' + item.id}">分享</a>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <button if.bind="!lastSearch" click.delegate="searchMoreHandler()" class="fluid ui basic button tms-search-more">加载更多(${moreSearchCnt})</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <em-confirm-modal em-confirm-modal.ref="emConfirmModal"></em-confirm-modal>\r\n</template>\r\n'}),define("text!app.css",["module"],function(n){n.exports="html,\nbody {\n  height: 100%;\n}\n::-webkit-scrollbar {\n  width: 6px;\n  height: 6px;\n}\n::-webkit-scrollbar-thumb {\n  border-radius: 6px;\n  background-color: #c6c6c6;\n}\n::-webkit-scrollbar-thumb:hover {\n  background: #999;\n}\n@media only screen and (min-width: 768px) {\n  .ui.modal.tms-md450 {\n    width: 450px!important;\n    margin-left: -225px !important;\n  }\n  .ui.modal.tms-md510 {\n    width: 510px!important;\n    margin-left: -255px !important;\n  }\n  .ui.modal.tms-md540 {\n    width: 540px!important;\n    margin-left: -275px !important;\n  }\n}\n/* for swipebox */\n#swipebox-overlay {\n  background: rgba(13, 13, 13, 0.5) !important;\n}\n.keyboard {\n  background: #fff;\n  font-weight: 700;\n  padding: 2px .35rem;\n  font-size: .8rem;\n  margin: 0 2px;\n  border-radius: .25rem;\n  color: #3d3c40;\n  border-bottom: 2px solid #9e9ea6;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);\n  text-shadow: none;\n}\n"}),define("text!test/test-lifecycle.html",["module"],function(n){n.exports='<template>\r\n    <!-- <require from=""></require> -->\r\n    <div class="ui container">\r\n        <h1 class="ui header">Aurelia框架模块生命周期钩子函数调用顺序测试(看console输出)</h1>\r\n    </div>\r\n</template>\r\n'}),define("text!chat/chat-direct.css",["module"],function(n){n.exports=".tms-chat-direct {\n  height: 100%;\n}\n.tms-chat-direct .top.fixed.menu {\n  padding-left: 220px;\n  height: 60px;\n}\n.tms-chat-direct .ui.left.sidebar {\n  background-color: #4d394b;\n  width: 220px;\n}\n.tms-chat-direct .ui.left.sidebar * {\n  color: #4183c4!important;\n}\n.tms-chat-direct .ui.left.sidebar .tms-header > input {\n  background-color: transparent;\n  border: 1px #676868 solid;\n  font-size: 12px;\n  padding: 4px;\n  width: 190px;\n  outline: none;\n  margin-top: 10px;\n  border-radius: 2px;\n}\n.tms-chat-direct .ui.left.sidebar .ui.list {\n  position: absolute;\n  bottom: 0;\n  top: 80px;\n  overflow-y: auto;\n  width: 190px;\n}\n.tms-chat-direct .ui.left.sidebar .ui.list a > i.circular.icon {\n  box-shadow: 0 0 0 0.1em #4183c4 inset;\n}\n.tms-chat-direct .ui.left.sidebar .ui.list::-webkit-scrollbar-thumb {\n  background-color: #475a81;\n}\n.tms-chat-direct .ui.left.sidebar .tms-header {\n  height: 40px;\n}\n.tms-chat-direct .ui.left.sidebar .tms-header i.close.icon {\n  position: absolute;\n  right: 11px;\n  top: 55px;\n  box-shadow: 0 0 0 0.1em #676868 inset;\n  border-top-right-radius: 2px;\n  border-bottom-right-radius: 2px;\n}\n.tms-chat-direct .ui.left.sidebar .tms-header .ui.header {\n  margin-bottom: 0;\n}\n.tms-chat-direct .tms-edit-textarea {\n  width: 100%;\n}\n.tms-chat-direct .ui.selection.list > .item {\n  cursor: default;\n}\n.tms-chat-direct .ui.search .prompt {\n  border-radius: .28571429rem;\n}\n.tms-chat-direct .tms-content {\n  position: absolute;\n  top: 60px;\n  left: 220px;\n  bottom: 0;\n  right: 0;\n  display: flex;\n  align-items: stretch;\n}\n.tms-chat-direct .tms-content.tms-sidebar-show .tms-right-sidebar {\n  width: 388px;\n  border-left: 1px #e9e9e9 solid;\n  transition: width 0.15s ease-out 0s;\n  margin: 4px;\n  margin-right: 0;\n}\n@media only screen and (max-width: 767px) {\n  .tms-chat-direct .tms-content {\n    left: 0;\n  }\n}\n.tms-chat-direct .tms-content-body {\n  width: 100%;\n  max-width: 100%;\n  flex: 1 1 0;\n  display: flex;\n  align-items: stretch;\n  padding-bottom: 73px;\n}\n.tms-chat-direct .tms-content-body .ui.comments {\n  overflow-y: auto;\n  flex: 1 1 0;\n  max-width: none;\n  margin-bottom: 12px;\n  margin-top: 10px;\n}\n.tms-chat-direct .tms-content-body .ui.comments .tms-pre-more {\n  margin-bottom: 10px;\n}\n.tms-chat-direct .tms-content-body .ui.comments .tms-next-more {\n  margin-top: 10px;\n}\n.tms-chat-direct .tms-right-sidebar {\n  width: 0;\n  overflow-y: auto;\n  padding-top: 10px;\n  padding-bottom: 10px;\n}\n.tms-chat-direct .ui.top.menu .item.tms-item:before {\n  display: none;\n}\n.tms-chat-direct .ui.top.menu > .ui.dropdown.item > .text > .icon {\n  display: none;\n}\n.tms-chat-direct .ui.top.menu .right.menu .item.tms-item {\n  padding-left: 5px;\n  padding-right: 5px;\n}\n.tms-chat-direct .ui.top.menu .right.menu .ui.search input {\n  width: 100px;\n  transition: width 0.15s ease-out 0s;\n}\n.tms-chat-direct .ui.top.menu .right.menu .ui.search i.remove.icon {\n  display: none;\n  position: absolute;\n  right: 0;\n  left: auto;\n}\n@media only screen and (max-width: 767px) {\n  .tms-chat-direct .ui.top.menu {\n    padding-left: 0;\n  }\n}\n.tms-chat-direct .ui.top.menu .ui.basic.button {\n  box-shadow: none;\n}\n@media only screen and (max-width: 767px) {\n  .tms-chat-direct .tms-left-sidebar {\n    display: none;\n  }\n}\n"}),define("text!user/user-login.html",["module"],function(n){n.exports='<template>\r\n    <require from="./user-login.css"></require>\r\n    <div class="tms-user-login">\r\n        <div class="container">\r\n            <h2 class="ui center aligned icon header">\r\n            <i class="circular users icon"></i> 用户登录\r\n            </h2>\r\n            <div class="ui form segment">\r\n                <div class="field">\r\n                    <div class="ui left icon input">\r\n                        <i class="user icon"></i>\r\n                        <input type="text" value.bind="username" placeholder="用户名" />\r\n                    </div>\r\n                </div>\r\n                <div class="field">\r\n                    <div class="ui left icon input">\r\n                        <i class="lock icon"></i>\r\n                        <input type="password" keydown.trigger="kdHandler($event)" value.bind="password" placeholder="密码" />\r\n                    </div>\r\n                </div>\r\n                <div class="field">\r\n                    <div ref="rememberMeRef" class="ui checkbox">\r\n                        <input type="checkbox" name="remember-me" />\r\n                        <label>记住我在此计算机的登录(2周)</label>\r\n                    </div>\r\n                </div>\r\n                <div class="ui center aligned header">\r\n                    <button click.delegate="loginHandler()" class="ui submit fluid button ${isReq ? \'disabled\' : \'\'}">登录</button>\r\n                </div>\r\n                <div style="text-align: center; font-size:12px;">\r\n                    <a href="#/pwd-reset">忘记密码</a> &nbsp;&nbsp;\r\n                    <a href="#/register">注册用户</a>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n'}),define("text!chat/md-github.css",["module"],function(n){n.exports='.markdown-body {\n  font-size: 14px;\n  line-height: 1.6;\n}\n.markdown-body > br,\n.markdown-body ul br .markdown-body ol br {\n  display: none;\n}\n.markdown-body > *:first-child {\n  margin-top: 0 !important;\n}\n.markdown-body > *:last-child {\n  margin-bottom: 0 !important;\n}\n.markdown-body a.absent {\n  color: #CC0000;\n}\n.markdown-body a.anchor {\n  bottom: 0;\n  cursor: pointer;\n  display: block;\n  left: 0;\n  margin-left: -30px;\n  padding-left: 30px;\n  position: absolute;\n  top: 0;\n}\n.markdown-body h1,\n.markdown-body h2,\n.markdown-body h3,\n.markdown-body h4,\n.markdown-body h5,\n.markdown-body h6 {\n  cursor: text;\n  font-weight: bold;\n  margin: 20px 0 10px;\n  padding: 0;\n  position: relative;\n}\n.markdown-body h1 .mini-icon-link,\n.markdown-body h2 .mini-icon-link,\n.markdown-body h3 .mini-icon-link,\n.markdown-body h4 .mini-icon-link,\n.markdown-body h5 .mini-icon-link,\n.markdown-body h6 .mini-icon-link {\n  color: #000000;\n  display: none;\n}\n.markdown-body h1:hover a.anchor,\n.markdown-body h2:hover a.anchor,\n.markdown-body h3:hover a.anchor,\n.markdown-body h4:hover a.anchor,\n.markdown-body h5:hover a.anchor,\n.markdown-body h6:hover a.anchor {\n  line-height: 1;\n  margin-left: -22px;\n  padding-left: 0;\n  text-decoration: none;\n  top: 15%;\n}\n.markdown-body h1:hover a.anchor .mini-icon-link,\n.markdown-body h2:hover a.anchor .mini-icon-link,\n.markdown-body h3:hover a.anchor .mini-icon-link,\n.markdown-body h4:hover a.anchor .mini-icon-link,\n.markdown-body h5:hover a.anchor .mini-icon-link,\n.markdown-body h6:hover a.anchor .mini-icon-link {\n  display: inline-block;\n}\n.markdown-body h1 tt,\n.markdown-body h1 code,\n.markdown-body h2 tt,\n.markdown-body h2 code,\n.markdown-body h3 tt,\n.markdown-body h3 code,\n.markdown-body h4 tt,\n.markdown-body h4 code,\n.markdown-body h5 tt,\n.markdown-body h5 code,\n.markdown-body h6 tt,\n.markdown-body h6 code {\n  font-size: inherit;\n}\n.markdown-body h1 {\n  color: #000000;\n  font-size: 28px;\n}\n.markdown-body h2 {\n  border-bottom: 1px solid #CCCCCC;\n  color: #000000;\n  font-size: 24px;\n}\n.markdown-body h3 {\n  font-size: 18px;\n}\n.markdown-body h4 {\n  font-size: 16px;\n}\n.markdown-body h5 {\n  font-size: 14px;\n}\n.markdown-body h6 {\n  color: #777777;\n  font-size: 14px;\n}\n.markdown-body p,\n.markdown-body blockquote,\n.markdown-body ul,\n.markdown-body ol,\n.markdown-body dl,\n.markdown-body table,\n.markdown-body pre {\n  margin: 15px 0;\n}\n.markdown-body hr {\n  overflow: hidden;\n  background: 0 0;\n}\n.markdown-body hr:before {\n  display: table;\n  content: "";\n}\n.markdown-body hr:after {\n  display: table;\n  clear: both;\n  content: "";\n}\n.markdown-body hr {\n  height: 4px;\n  padding: 0;\n  margin: 16px 0;\n  background-color: #e7e7e7;\n  border: 0;\n}\n.markdown-body hr {\n  -moz-box-sizing: content-box;\n  box-sizing: content-box;\n}\n.markdown-body > h2:first-child,\n.markdown-body > h1:first-child,\n.markdown-body > h1:first-child + h2,\n.markdown-body > h3:first-child,\n.markdown-body > h4:first-child,\n.markdown-body > h5:first-child,\n.markdown-body > h6:first-child {\n  margin-top: 0;\n  padding-top: 0;\n}\n.markdown-body a:first-child h1,\n.markdown-body a:first-child h2,\n.markdown-body a:first-child h3,\n.markdown-body a:first-child h4,\n.markdown-body a:first-child h5,\n.markdown-body a:first-child h6 {\n  margin-top: 0;\n  padding-top: 0;\n}\n.markdown-body h1 + p,\n.markdown-body h2 + p,\n.markdown-body h3 + p,\n.markdown-body h4 + p,\n.markdown-body h5 + p,\n.markdown-body h6 + p {\n  margin-top: 0;\n}\n.markdown-body li p.first {\n  display: inline-block;\n}\n.markdown-body ul,\n.markdown-body ol {\n  padding-left: 30px;\n}\n.markdown-body ul.no-list,\n.markdown-body ol.no-list {\n  list-style-type: none;\n  padding: 0;\n}\n.markdown-body ul li > *:first-child,\n.markdown-body ol li > *:first-child {\n  margin-top: 0;\n}\n.markdown-body ul ul,\n.markdown-body ul ol,\n.markdown-body ol ol,\n.markdown-body ol ul {\n  margin-bottom: 0;\n}\n.markdown-body dl {\n  padding: 0;\n}\n.markdown-body dl dt {\n  font-size: 14px;\n  font-style: italic;\n  font-weight: bold;\n  margin: 15px 0 5px;\n  padding: 0;\n}\n.markdown-body dl dt:first-child {\n  padding: 0;\n}\n.markdown-body dl dt > *:first-child {\n  margin-top: 0;\n}\n.markdown-body dl dt > *:last-child {\n  margin-bottom: 0;\n}\n.markdown-body dl dd {\n  margin: 0 0 15px;\n  padding: 0 15px;\n}\n.markdown-body dl dd > *:first-child {\n  margin-top: 0;\n}\n.markdown-body dl dd > *:last-child {\n  margin-bottom: 0;\n}\n.markdown-body blockquote {\n  border-left: 4px solid #DDDDDD;\n  color: #777777;\n  padding: 0 15px;\n}\n.markdown-body blockquote > *:first-child {\n  margin-top: 0;\n}\n.markdown-body blockquote > *:last-child {\n  margin-bottom: 0;\n}\n.markdown-body table th {\n  font-weight: bold;\n}\n.markdown-body table th,\n.markdown-body table td {\n  border: 1px solid #CCCCCC;\n  padding: 6px 13px;\n}\n.markdown-body table tr {\n  background-color: #FFFFFF;\n  border-top: 1px solid #CCCCCC;\n}\n.markdown-body table tr:nth-child(2n) {\n  background-color: #F8F8F8;\n}\n.markdown-body img {\n  max-width: 100%;\n}\n.markdown-body span.frame {\n  display: block;\n  overflow: hidden;\n}\n.markdown-body span.frame > span {\n  border: 1px solid #DDDDDD;\n  display: block;\n  float: left;\n  margin: 13px 0 0;\n  overflow: hidden;\n  padding: 7px;\n  width: auto;\n}\n.markdown-body span.frame span img {\n  display: block;\n  float: left;\n}\n.markdown-body span.frame span span {\n  clear: both;\n  color: #333333;\n  display: block;\n  padding: 5px 0 0;\n}\n.markdown-body span.align-center {\n  clear: both;\n  display: block;\n  overflow: hidden;\n}\n.markdown-body span.align-center > span {\n  display: block;\n  margin: 13px auto 0;\n  overflow: hidden;\n  text-align: center;\n}\n.markdown-body span.align-center span img {\n  margin: 0 auto;\n  text-align: center;\n}\n.markdown-body span.align-right {\n  clear: both;\n  display: block;\n  overflow: hidden;\n}\n.markdown-body span.align-right > span {\n  display: block;\n  margin: 13px 0 0;\n  overflow: hidden;\n  text-align: right;\n}\n.markdown-body span.align-right span img {\n  margin: 0;\n  text-align: right;\n}\n.markdown-body span.float-left {\n  display: block;\n  float: left;\n  margin-right: 13px;\n  overflow: hidden;\n}\n.markdown-body span.float-left span {\n  margin: 13px 0 0;\n}\n.markdown-body span.float-right {\n  display: block;\n  float: right;\n  margin-left: 13px;\n  overflow: hidden;\n}\n.markdown-body span.float-right > span {\n  display: block;\n  margin: 13px auto 0;\n  overflow: hidden;\n  text-align: right;\n}\n.markdown-body code,\n.markdown-body tt {\n  background-color: #F8F8F8;\n  border: 1px solid #EAEAEA;\n  border-radius: 3px 3px 3px 3px;\n  margin: 0 2px;\n  padding: 0 5px;\n  white-space: nowrap;\n}\n.markdown-body pre > code {\n  background: none repeat scroll 0 0 transparent;\n  border: medium none;\n  margin: 0;\n  padding: 0;\n  white-space: pre;\n}\n.markdown-body .highlight pre,\n.markdown-body pre {\n  background-color: #F8F8F8;\n  border: 1px solid #CCCCCC;\n  border-radius: 3px 3px 3px 3px;\n  font-size: 13px;\n  line-height: 19px;\n  overflow: auto;\n  padding: 6px 10px;\n}\n.markdown-body pre code,\n.markdown-body pre tt {\n  background-color: transparent;\n  border: medium none;\n}\n';
}),define("text!user/user-pwd-reset.html",["module"],function(n){n.exports='<template>\r\n    <require from="./user-pwd-reset.css"></require>\r\n    <div class="ui container tms-user-pwd-reset">\r\n        <div class="tms-flex">\r\n            <div if.bind="!token" ref="fm" class="ui form segment" style="width: 260px;">\r\n                <div class="ui message">输入您的邮箱地址,我们会发送密码重置链接到您的邮箱!</div>\r\n                <div class="field">\r\n                    <label style="display:none;">邮件地址</label>\r\n                    <input type="text" name="mail" autofocus="" value.bind="mail" placeholder="输入您的邮件地址">\r\n                </div>\r\n                <div class="ui green fluid button ${isReq ? \'disabled\' : \'\'}" click.delegate="resetPwdHandler()">发送密码重置邮件</div>\r\n            </div>\r\n            <div if.bind="token" ref="fm2" class="ui form segment" style="width: 260px;">\r\n                <div class="ui message">设置您的新密码,密码长度要求至少8位字符!</div>\r\n                <div class="field">\r\n                    <label style="display:none;">新密码</label>\r\n                    <input type="password" name="mail" autofocus="" value.bind="pwd" placeholder="设置您的新密码">\r\n                </div>\r\n                <div class="ui green fluid button ${isReq ? \'disabled\' : \'\'}" click.delegate="newPwdHandler()">确认</div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n'}),define("text!user/user-login.css",["module"],function(n){n.exports=".tms-user-login {\n  width: 100%;\n  min-height: 100%;\n  background-color: #5a3636;\n  overflow: hidden;\n}\n.tms-user-login .container {\n  width: 300px;\n  top: 50px;\n  margin-left: auto;\n  margin-right: auto;\n  position: relative;\n}\n.tms-user-login h2 {\n  color: rgba(197, 164, 164, 0.8) !important;\n}\n.tms-user-login .ui.form {\n  background-color: #353131;\n}\n.tms-user-login .ui.error.message {\n  background-color: #5a3636;\n}\n.tms-user-login .ui.error.message .header {\n  color: #e0b4b4;\n}\n.tms-user-login .ui.checkbox label {\n  color: #ad8b8b;\n}\n.tms-user-login .ui.checkbox input:focus ~ label {\n  color: #ad8b8b;\n}\n.tms-user-login .ui.checkbox label:hover {\n  color: #ad8b8b;\n}\n.tms-user-login .ui.button {\n  background-color: #5a3636;\n  color: #ad8b75;\n}\n"}),define("text!user/user-register.html",["module"],function(n){n.exports='<template>\r\n    <require from="./user-register.css"></require>\r\n    <div class="ui container tms-user-register">\r\n        <div class="tms-flex">\r\n            <div if.bind="!token" ref="fm" class="ui form segment" style="width: 280px;">\r\n                <div class="ui message">提交账户注册信息成功后,我们会向您的注册邮箱发送一封账户激活邮件,激活账户后即可登录!</div>\r\n                <div class="required field">\r\n                    <label>用户名</label>\r\n                    <input type="text" name="username" autofocus="" value.bind="username" placeholder="输入您的登录用户名">\r\n                </div>\r\n                <div class="required field">\r\n                    <label>密码</label>\r\n                    <input type="password" name="pwd" autofocus="" value.bind="pwd" placeholder="输入您的登录密码">\r\n                </div>\r\n                <div class="required field">\r\n                    <label>姓名</label>\r\n                    <input type="text" name="name" autofocus="" value.bind="name" placeholder="输入您的显示名称">\r\n                </div>\r\n                <div class="required field">\r\n                    <label>邮箱</label>\r\n                    <input type="text" name="mail" autofocus="" value.bind="mail" placeholder="输入您的账户激活邮箱">\r\n                </div>\r\n                <div class="ui green fluid button ${isReq ? \'disabled\' : \'\'}" click.delegate="okHandler()">确认</div>\r\n            </div>\r\n            <div if.bind="token" class="ui center aligned very padded segment" style="width: 320px;">\r\n            \t<h1 class="ui header">${header}</h1>\r\n            \t<a href="/admin/login" class="ui green button">返回登录页面</a>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n'}),define("text!user/user-pwd-reset.css",["module"],function(n){n.exports=".tms-user-pwd-reset {\n  height: 100%;\n}\n.tms-user-pwd-reset .tms-flex {\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n"}),define("text!resources/elements/em-chat-input.html",["module"],function(n){n.exports='<template>\n    <require from="./em-chat-input.css"></require>\n    <require from="./em-hotkeys-modal"></require>\n    <div class="ui basic segment tms-msg-input tms-em-chat-input dropzone">\n        <div ref="inputRef" class="ui left action fluid icon input dropzone">\n            <div ref="chatBtnRef" class="ui icon button">\n                <i class="plus icon"></i>\n            </div>\n            <div class="ui flowing popup bottom left transition hidden">\n                <div class="ui middle aligned selection list">\n                    <div ref="btnItemUploadRef" class="item">\n                        <i class="upload icon"></i>\n                        <div class="content">\n                            上传文件\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="textareaWrapper">\n                <textarea ref="chatInputRef" placeholder="输入聊天内容(按下 / 键提示补全) (Ctrl+Enter发送,Esc清空)"></textarea>\n            </div>\n            <i click.delegate="sendChatMsgHandler()" title="发送消息(Enter)" class="send link icon"></i>\n        </div>\n        <div ref="uploadProgressRef" class="tms-upload-progress dropzone-previews"></div>\n    </div>\n    <div ref="previewTemplateRef" style="display: none;">\n        <div class="dz-preview dz-file-preview">\n            <div class="dz-details">\n                <div class="dz-filename"><span data-dz-name></span></div>\n                <div class="dz-size" data-dz-size></div>\n                <img data-dz-thumbnail />\n            </div>\n            <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n            <div class="dz-success-mark"><span>✔</span></div>\n            <div class="dz-error-mark"><span>✘</span></div>\n            <div class="dz-error-message"><span data-dz-errormessage></span></div>\n        </div>\n    </div>\n    <em-hotkeys-modal em-hotkeys-modal.ref="emHotkeysModal"></em-hotkeys-modal>\n</template>\n'}),define("text!user/user-register.css",["module"],function(n){n.exports=".tms-user-register {\n  height: 100%;\n}\n.tms-user-register .tms-flex {\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n"}),define("text!resources/elements/em-confirm-modal.html",["module"],function(n){n.exports='<template>\n    <div ref="md" class="ui small modal nx-ui-confirm tms-md450">\n        <div class="header">\n            ${config.title}\n        </div>\n        <div class="content">\n            <i if.bind="config.warning" class="large yellow warning sign icon" style="float: left;"></i>\n            <i if.bind="!config.warning" class="large blue info circle icon" style="float: left;"></i>\n            <p style="margin-left: 20px;">\n                <span innerhtml.bind="config.content"></span>\n            </p>\n        </div>\n        <div class="actions">\n            <div class="ui cancel basic blue left floated button">取消</div>\n            <div class="ui ok blue button">确认</div>\n        </div>\n    </div>\n</template>\n'}),define("text!resources/elements/em-chat-input.css",["module"],function(n){n.exports='.tms-em-chat-input.ui.segment {\n  margin: 0;\n  position: fixed;\n  bottom: 0;\n  left: 220px;\n  right: 0;\n  background-color: white;\n  padding-bottom: 22px;\n}\n@media only screen and (max-width: 767px) {\n  .tms-em-chat-input.ui.segment {\n    left: 0;\n  }\n}\n.tms-em-chat-input.ui.segment .tms-upload-progress {\n  position: absolute;\n  bottom: 75px;\n  right: 15px;\n  left: 15px;\n}\n.tms-em-chat-input.ui.segment .tms-upload-progress .dz-preview {\n  display: block!important;\n  width: auto!important;\n  background: #e0e1e2;\n  margin: 0;\n  padding: 7px;\n}\n.tms-em-chat-input.ui.segment .ui[class*="left action"].input > textarea {\n  border-top-left-radius: 0!important;\n  border-bottom-left-radius: 0!important;\n  border-left-color: transparent!important;\n}\n.tms-em-chat-input.ui.segment .textareaWrapper {\n  max-width: 100%;\n  -webkit-box-flex: 1;\n  -webkit-flex: 1 0 auto;\n  -ms-flex: 1 0 auto;\n  flex: 1 0 auto;\n  border: 1px solid rgba(34, 36, 38, 0.15);\n  border-top-right-radius: .28571429rem;\n  border-bottom-right-radius: .28571429rem;\n}\n.tms-em-chat-input.ui.segment .textareaWrapper .CodeMirror,\n.tms-em-chat-input.ui.segment .textareaWrapper .CodeMirror-scroll {\n  min-height: 0;\n  border: none;\n}\n.tms-em-chat-input.ui.segment .textareaWrapper .CodeMirror-scroll {\n  max-height: 300px;\n}\n.tms-em-chat-input.ui.segment .ui.input textarea {\n  resize: none;\n  width: 100%;\n  padding-right: 2.67142857em!important;\n  margin: 0;\n  max-width: 100%;\n  outline: 0;\n  -webkit-tap-highlight-color: rgba(255, 255, 255, 0);\n  text-align: left;\n  display: block;\n  padding: .67861429em 1em;\n  background: #FFF;\n  border: none;\n  color: rgba(0, 0, 0, 0.87);\n  box-shadow: none;\n  border-top-right-radius: .28571429rem;\n  border-bottom-right-radius: .28571429rem;\n}\n.tms-chat-direct .tms-content.tms-sidebar-show .tms-em-chat-input {\n  right: 392px;\n}\n.textcomplete-dropdown {\n  position: static!important;\n  border: 1px solid #ddd;\n  background-color: white;\n  list-style: none;\n  padding: 0;\n  margin: 0;\n  border-radius: 5px;\n}\n.textcomplete-dropdown li {\n  /* border-top: 1px solid #ddd; */\n  padding: 2px 5px;\n}\n.textcomplete-dropdown li:first-child {\n  border-top: none;\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n}\n.textcomplete-dropdown li:last-child {\n  border-bottom-left-radius: 5px;\n  border-bottom-right-radius: 5px;\n}\n.textcomplete-dropdown li:hover,\n.textcomplete-dropdown .active {\n  background-color: #439fe0;\n}\n.textcomplete-dropdown a:hover {\n  cursor: pointer;\n}\n.textcomplete-dropdown li.textcomplete-item a {\n  color: black;\n}\n.textcomplete-dropdown li.textcomplete-item:hover a,\n.textcomplete-dropdown li.textcomplete-item.active a {\n  color: white;\n}\n'}),define("text!resources/elements/em-hotkeys-modal.html",["module"],function(n){n.exports='<template>\r\n    <require from="./em-hotkeys-modal.css"></require>\r\n    <div ref="md" class="ui basic modal tms-em-hotkeys-modal">\r\n        <i class="close icon"></i>\r\n        <!-- <div class="header">\r\n            Archive Old Messages\r\n        </div> -->\r\n        <div class="content">\r\n            <h1 class="ui center inverted aligned header">键盘快捷键\r\n\t\t\t\t<span style="position: relative; top: -0.375rem; left: 1rem;" aria-hidden="true">\r\n\t\t\t\t\t<span class="keyboard" aria-label="Control">Ctrl</span>\r\n\t\t\t\t\t<span class="keyboard" aria-label="Question mark">/</span>\r\n\t\t\t\t</span>\r\n            </h1>\r\n            <div class="ui grid">\r\n                <div class="three column row">\r\n                    <div class="column">\r\n                        <ul class="no_bullets">\r\n                            <li>上一条: <span class="keyboard">Alt</span><span class="keyboard"><i class="long arrow up icon" aria-label="Up arrow"></i></span></li>\r\n                            <li>下一条: <span class="keyboard">Alt</span><span class="keyboard"><i class="long arrow down icon" aria-label="Down arrow"></i></span></li>\r\n                            <li>上一条未读: <span class="keyboard">Alt</span><span class="keyboard">Shift</span><span class="keyboard"><i class="long arrow up icon" aria-label="Up arrow"></i></span></li>\r\n                            <li>下一条未读: <span class="keyboard">Alt</span><span class="keyboard">Shift</span><span class="keyboard"><i class="long arrow down icon" aria-label="Down arrow"></i></span></li>\r\n                            <li>历史回退: <span class="keyboard">Alt</span><span class="keyboard"><i class="long arrow left icon" aria-label="Left arrow"></i></span></li>\r\n                            <li>历史向前: <span class="keyboard">Alt</span><span class="keyboard"><i class="long arrow right icon" aria-label="Right arrow"></i></span></li>\r\n                            <li>标记已读: <span class="keyboard" aria-label="Escape">Esc</span></li>\r\n                            <li>全部标记已读: <span class="keyboard">Shift</span><span class="keyboard" aria-label="Escape">Esc</span></li>\r\n                            <li>快速切换: <span class="keyboard" aria-label="Control">Ctrl</span><span class="keyboard">k</span></li>\r\n                            <li>Browse DMs: <span class="keyboard" aria-label="Control">Ctrl</span><span class="keyboard">Shift</span><span class="keyboard">k</span></li>\r\n                        </ul>\r\n                    </div>\r\n                    <div class="column">\r\n                        <ul class="no_bullets">\r\n                            <li>\r\n                                自动补全\r\n                                <ul>\r\n                                    <li>名称: <span class="subtle_silver">[a-z]</span><span class="keyboard">Tab</span> <span class="subtle_silver">or</span> <span class="keyboard">@</span><span class="keyboard">Tab</span></li>\r\n                                    <li>频道: <span class="keyboard" aria-label="Number symbol">#</span><span class="keyboard">Tab</span></li>\r\n                                    <li>表情: <span class="keyboard" aria-label="Colon">:</span><span class="keyboard">Tab</span></li>\r\n                                </ul>\r\n                            </li>\r\n                            <li>换行: <span class="keyboard">Shift</span><span class="keyboard">Enter</span></li>\r\n                            <li>编辑上一条: <span class="keyboard"><i class="long arrow up icon" aria-label="Up arrow"></i></span> <span class="subtle_silver">in input</span></li>\r\n                            <li>响应最后一条: <span class="keyboard" aria-label="control">Ctrl</span><span class="keyboard">Shift</span><span class="keyboard">\\</span></li>\r\n                        </ul>\r\n                    </div>\r\n                    <div class="column">\r\n                        <ul class="no_bullets">\r\n                            <li>切换边栏: <span class="keyboard" aria-label="Control">Ctrl</span><span class="keyboard">.</span></li>\r\n                            <ul>\r\n                                <li>团队: <span class="keyboard" aria-label="Control">Ctrl</span><span class="keyboard">Shift</span><span class="keyboard">e</span></li>\r\n                                <li>标星: <span class="keyboard" aria-label="Control">Ctrl</span><span class="keyboard">Shift</span><span class="keyboard">s</span></li>\r\n                            </ul>\r\n                            <li>粘贴代码片段: <span class="keyboard" aria-label="Control">Ctrl</span><span class="keyboard">Shift</span><span class="keyboard">Enter</span></li>\r\n                            <li>上传文件: <span class="keyboard" aria-label="Control">Ctrl</span><span class="keyboard">u</span></li>\r\n                            <li>关闭对话框: <span class="keyboard" aria-label="Escape">Esc</span></li>\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <!-- <div class="image">\r\n                <i class="archive icon"></i>\r\n            </div>\r\n            <div class="description">\r\n                <p>Your inbox is getting full, would you like us to enable automatic archiving of old messages?</p>\r\n            </div> -->\r\n        </div>\r\n        <!-- <div class="actions">\r\n            <div class="two fluid ui inverted buttons">\r\n                <div class="ui cancel red basic inverted button">\r\n                    <i class="remove icon"></i> No\r\n                </div>\r\n                <div class="ui ok green basic inverted button">\r\n                    <i class="checkmark icon"></i> Yes\r\n                </div>\r\n            </div>\r\n        </div> -->\r\n    </div>\r\n</template>\r\n'}),define("text!resources/elements/em-hotkeys-modal.css",["module"],function(n){n.exports=".tms-em-hotkeys-modal ul {\n  padding-left: 30px;\n}\n.tms-em-hotkeys-modal ul.no_bullets {\n  margin: 0 0 2rem;\n}\n.tms-em-hotkeys-modal ul.no_bullets li {\n  line-height: 2rem;\n  list-style-type: none;\n  padding: 0;\n  font-size: 1rem;\n  font-weight: 700;\n}\n.tms-em-hotkeys-modal > .content {\n  background-color: rgba(11, 7, 11, 0.78) !important;\n}\n.tms-em-hotkeys-modal .keyboard i.icon {\n  margin-right: 0px!important;\n}\n.tms-em-hotkeys-modal .subtle_silver {\n  color: #9e9ea6!important;\n}\n.tms-em-hotkeys-modal .ui.grid .column {\n  padding: 0!important;\n}\n"});